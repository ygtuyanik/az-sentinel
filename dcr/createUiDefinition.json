{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [
      {
        "name": "dcrName",
        "type": "Microsoft.Common.TextBox",
        "label": "Data Collection Rule Name",
        "defaultValue": "DCR-CEF-SYSLOG-MERGED",
        "toolTip": "Name of the Data Collection Rule",
        "constraints": {
          "required": true
        }
      },
      {
        "name": "region",
        "type": "Microsoft.Common.LocationDropdown",
        "label": "Region",
        "toolTip": "Azure region for the Data Collection Rule",
        "defaultValue": "East US 2",
        "constraints": {
          "required": true
        }
      }
    ],
    "steps": [
      {
        "name": "workspaceConfig",
        "label": "Log Analytics Workspace",
        "elements": [
          {
            "name": "logAnalyticsWorkspaceResourceId",
            "type": "Microsoft.Common.TextBox",
            "label": "Workspace Resource ID",
            "toolTip": "Full resource ID of the Log Analytics workspace (e.g. /subscriptions/{subId}/resourceGroups/{rg}/providers/Microsoft.OperationalInsights/workspaces/{name})",
            "constraints": {
              "required": true,
              "regex": "^/subscriptions/[^/]+/resourceGroups/[^/]+/providers/Microsoft.OperationalInsights/workspaces/[^/]+$",
              "validationMessage": "Please enter a valid Log Analytics workspace resource ID"
            }
          },
          {
            "name": "logAnalyticsWorkspaceId",
            "type": "Microsoft.Common.TextBox",
            "label": "Workspace ID (GUID)",
            "toolTip": "Log Analytics workspace ID (GUID format)",
            "constraints": {
              "required": true,
              "regex": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "validationMessage": "Please enter a valid GUID"
            }
          }
        ]
      }
    ],
    "outputs": {
      "dcrName": "[basics('dcrName')]",
      "region": "[basics('region')]",
      "logAnalyticsWorkspaceResourceId": "[steps('workspaceConfig').logAnalyticsWorkspaceResourceId]",
      "logAnalyticsWorkspaceId": "[steps('workspaceConfig').logAnalyticsWorkspaceId]"
    }
  }
}
